# =======================
# Application Info
# =======================
spring.application.name=auth-service
server.port=8081

# =======================
# R2DBC PostgreSQL Config (Runtime)
# =======================
# =======================
# R2DBC - PostgreSQL Local
# =======================
# R2DBC PostgreSQL Config (Local)
# =======================
spring.r2dbc.url=r2dbc:postgresql://localhost:5432/eduauth
spring.r2dbc.username=Anand
spring.r2dbc.password=1008
spring.r2dbc.pool.enabled=true
spring.r2dbc.pool.initial-size=5
spring.r2dbc.pool.max-size=10
spring.r2dbc.pool.max-idle-time=30m

# =======================
# Flyway Config (JDBC for schema migration)
# =======================
spring.flyway.enabled=false
spring.flyway.url=jdbc:postgresql://localhost:5432/eduauth
spring.flyway.user=Anand
spring.flyway.password=1008
spring.flyway.locations=classpath:db/migration
spring.flyway.baseline-on-migrate=true


# Redis Config
# =======================
# Redis Configuration (Updated)
spring.data.redis.host=localhost
spring.data.redis.port=6379
# Password (remove if not set in redis.conf)


spring.data.redis.lettuce.pool.max-active=20
spring.data.redis.lettuce.pool.max-idle=10
spring.data.redis.lettuce.pool.min-idle=5


# Connection resilience
spring.data.redis.lettuce.cluster.refresh.adaptive=false
spring.data.redis.lettuce.pool.max-wait=1000s

# Timeouts (adjusted for Redis 3.x)
spring.data.redis.timeout=1000s
spring.data.redis.lettuce.shutdown-timeout=2000ms

# Security (critical for Redis 3.x)

# =======================
# Kafka Config (Docker-Based)
# =======================
# =======================
# Kafka Config (Docker-Based)
# =======================
spring.kafka.bootstrap-servers=localhost:29092
kafka.topics.user-created=user.created
spring.kafka.producer.key-serializer=org.apache.kafka.common.serialization.StringSerializer
spring.kafka.producer.value-serializer=org.apache.kafka.common.serialization.StringSerializer
spring.kafka.producer.acks=all
spring.kafka.producer.retries=5
spring.kafka.producer.batch-size=16384
spring.kafka.producer.buffer-memory=33554432
spring.kafka.producer.properties.linger.ms=1
spring.kafka.producer.properties.delivery.timeout.ms=30000
spring.kafka.producer.properties.request.timeout.ms=15000
spring.kafka.producer.properties.max.block.ms=5000
spring.kafka.consumer.auto-offset-reset=earliest
spring.kafka.consumer.properties.session.timeout.ms=45000
spring.kafka.consumer.properties.heartbeat.interval.ms=3000


# Reactive Kafka Timeouts
spring.kafka.reactive.timeout=30s
spring.kafka.reactive.retry.initial-interval=1s
spring.kafka.reactive.retry.max-attempts=3
spring.kafka.reactive.retry.max-interval=10s
auto.create.topics.enable=true

# Retry configuration for Kafka consumer
spring.kafka.consumer.max-poll-interval-ms=300000
spring.kafka.consumer.enable-auto-commit=false
spring.kafka.consumer.max-poll-records=10

# Error handling
spring.kafka.listener.ack-mode=MANUAL_IMMEDIATE
spring.kafka.listener.missing-topics-fatal=false


# =======================
# JWT
# =======================
jwt.secret=your-strong-256-bit-base64-secret
jwt.expiration=3600000
jwt.refresh.expiration=604800000

# =======================
# OAuth2 Clients (Google/GitHub)
# =======================
# Google OAuth2 Configuration
spring.security.oauth2.client.registration.google.client-id=1076730005679-9bnfq1jj5etr961d3naeojo1mkkld9mg.apps.googleusercontent.com
spring.security.oauth2.client.registration.google.client-secret=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
spring.security.oauth2.client.registration.google.redirect-uri=http://localhost:8081/login/oauth2/code/google
spring.security.oauth2.client.registration.google.scope=email,profile

# GitHub OAuth2 Configuration
spring.security.oauth2.client.registration.github.client-id=Ov23li4RfkQJcmY1tRL8
spring.security.oauth2.client.registration.github.client-secret=db8511f7066212caa04fe1867e7786c381253b3a
spring.security.oauth2.client.registration.github.redirect-uri=http://localhost:8081/login/oauth2/code/github
spring.security.oauth2.client.registration.github.scope=user:email

# Additional OAuth2 Configuration
spring.security.oauth2.client.provider.google.authorization-uri=https://accounts.google.com/o/oauth2/v2/auth
spring.security.oauth2.client.provider.google.token-uri=https://oauth2.googleapis.com/token
spring.security.oauth2.client.provider.google.user-info-uri=https://openidconnect.googleapis.com/v1/userinfo
spring.security.oauth2.client.provider.google.jwk-set-uri=https://www.googleapis.com/oauth2/v3/certs

spring.security.oauth2.client.provider.github.authorization-uri=https://github.com/login/oauth/authorize
spring.security.oauth2.client.provider.github.token-uri=https://github.com/login/oauth/access_token
spring.security.oauth2.client.provider.github.user-info-uri=https://api.github.com/user
# =======================
# Resilience4j Retry
# =======================
resilience4j.retry.instances.kafka-retry.max-attempts=3
resilience4j.retry.instances.kafka-retry.wait-duration=1s
resilience4j.retry.instances.kafka-retry.enableExponentialBackoff=true
resilience4j.retry.instances.kafka-retry.exponentialBackoffMultiplier=2
resilience4j.retry.instances.kafka-retry.maxWaitDuration=10s

# =======================
# Logging
# =======================
logging.level.root=INFO
logging.level.com.eduhub.auth_service=DEBUG
logging.level.org.springframework.security=DEBUG
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n
logging.file.name=logs/auth-service.log
logging.logback.rollingpolicy.max-file-size=10MB
logging.logback.rollingpolicy.max-history=7

# =======================
# Actuator + Prometheus
# =======================
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=always
management.metrics.tags.application=${spring.application.name}
management.metrics.distribution.percentiles-histogram.http.server.requests=true
management.metrics.distribution.sla.http.server.requests=100ms,200ms,500ms

# =======================
# Swagger/OpenAPI
# =======================
springdoc.api-docs.enabled=true
springdoc.api-docs.path=/v3/api-docs
springdoc.swagger-ui.path=/swagger-ui.html

# Email Configuration
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=smileyishere1008@gmail.com
spring.mail.password=fqdt liqa kfiy nbbf
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true

# =======================
# Application Info
# =======================
spring.application.name=auth-service
server.port=8081

# =======================
# R2DBC PostgreSQL Config
# =======================
spring.r2dbc.url=r2dbc:postgresql://localhost:5432/edu_auth
spring.r2dbc.username=Anand
spring.r2dbc.password=1008
spring.r2dbc.pool.enabled=true
spring.r2dbc.pool.initial-size=10
spring.r2dbc.pool.max-size=50
spring.r2dbc.pool.max-idle-time=30m

# Flyway - JDBC (Flyway does NOT support R2DBC)
spring.flyway.enabled=true
spring.flyway.url=jdbc:postgresql://localhost:5432/eduhub_auth
spring.flyway.user=postgres
spring.flyway.password=secure_password
spring.flyway.locations=classpath:db/migration

# =======================
# Redis Config
# =======================
spring.data.redis.host=localhost
spring.data.redis.port=6379
spring.data.redis.password=your_password
spring.data.redis.timeout=10s

spring.data.redis.lettuce.pool.max-active=20
spring.data.redis.lettuce.pool.max-idle=10
spring.data.redis.lettuce.pool.min-idle=5

# =======================
# Kafka Config (Docker-Based)
# =======================
spring.kafka.bootstrap-servers=localhost:9092
spring.kafka.producer.key-serializer=org.apache.kafka.common.serialization.StringSerializer
spring.kafka.producer.value-serializer=org.apache.kafka.common.serialization.StringSerializer
spring.kafka.producer.acks=all
spring.kafka.producer.retries=3
spring.kafka.producer.batch-size=16384
spring.kafka.producer.buffer-memory=33554432
spring.kafka.template.default-topic=${kafka.topics.user-created}
kafka.topics.user-created=user.created

# =======================
# JWT
# =======================
jwt.secret=${JWT_SECRET:your-strong-256-bit-base64-secret}
jwt.expiration=3600000
jwt.refresh.expiration=604800000

# =======================
# OAuth2 Clients (Google/GitHub)
# =======================
spring.security.oauth2.client.registration.google.client-id=1076730005679-9bnfq1jj5etr961d3naeojo1mkkld9mg.apps.googleusercontent.com
spring.security.oauth2.client.registration.google.client-secret=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
spring.security.oauth2.client.registration.google.redirect-uri=http://localhost:8081/login/oauth2/code/google

spring.security.oauth2.client.registration.github.client-id=Ov23li4RfkQJcmY1tRL8
spring.security.oauth2.client.registration.github.client-secret=db8511f7066212caa04fe1867e7786c381253b3a
spring.security.oauth2.client.registration.github.redirect-uri=http://localhost:8081/login/oauth2/code/github
# =======================
# Resilience4j Retry
# =======================
resilience4j.retry.instances.kafka-retry.max-attempts=3
resilience4j.retry.instances.kafka-retry.wait-duration=1s
resilience4j.retry.instances.kafka-retry.enableExponentialBackoff=true
resilience4j.retry.instances.kafka-retry.exponentialBackoffMultiplier=2
resilience4j.retry.instances.kafka-retry.maxWaitDuration=10s
# resilience4j.retry.instances.kafka-retry.retry-exceptions=com.eduhub.auth_service.exception.EventPublishingException
# resilience4j.retry.instances.kafka-retry.ignore-exceptions=java.lang.IllegalArgumentException

# =======================
# Logging
# =======================
logging.level.root=INFO
logging.level.com.eduhub.auth_service=DEBUG
logging.level.org.springframework.security=DEBUG

logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n
logging.file.name=logs/auth-service.log
logging.logback.rollingpolicy.max-file-size=10MB
logging.logback.rollingpolicy.max-history=7

# =======================
# Actuator + Prometheus
# =======================
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=always
management.metrics.tags.application=${spring.application.name}
management.metrics.distribution.percentiles-histogram.http.server.requests=true
management.metrics.distribution.sla.http.server.requests=100ms,200ms,500ms
